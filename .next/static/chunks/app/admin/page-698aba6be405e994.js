(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8937:function(e,t,s){Promise.resolve().then(s.bind(s,9725))},9725:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),i=s(9376),n=s(970);function d(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)([]),[d,l]=(0,a.useState)(0),[o,c]=(0,a.useState)(!0),[m,u]=(0,a.useState)(null),[x,p]=(0,a.useState)("pending"),[h,g]=(0,a.useState)(null),[b,f]=(0,a.useState)(""),[y,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{j()},[]),(0,a.useEffect)(()=>{N()},[x]);let j=async()=>{let t=(0,n.W)(),{data:{user:s}}=await t.auth.getUser();if(!s){e.push("/login");return}let{data:r}=await t.from("user_profiles").select("role").eq("id",s.id).single();if((null==r?void 0:r.role)!=="admin"){e.push("/app");return}},N=async()=>{c(!0),u(null);try{let r=await fetch("/api/admin/reports?status=".concat(x)),a=await r.json();if(!r.ok){var t;if(401===r.status){e.push("/login");return}if(403===r.status){e.push("/app");return}throw Error((null===(t=a.error)||void 0===t?void 0:t.message)||"Failed to fetch reports")}s(a.reports),l(a.total)}catch(e){u(e instanceof Error?e.message:"An error occurred")}finally{c(!1)}},w=async(e,t,r)=>{if(["hide","warn_user","ban_user"].includes(t)&&!r){v({reportId:e,action:t});return}g(e),u(null);try{let i=await fetch("/api/admin/reports/".concat(e,"/action"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,reason:r})}),n=await i.json();if(!i.ok){var a;throw Error((null===(a=n.error)||void 0===a?void 0:a.message)||"Action failed")}s(t=>t.filter(t=>t.id!==e)),l(e=>e-1),v(null),f("")}catch(e){u(e instanceof Error?e.message:"Action failed")}finally{g(null)}},_=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=e=>{switch(e){case"inappropriate":return"bg-red-100 text-red-800";case"spam":return"bg-yellow-100 text-yellow-800";case"copyright":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,r.jsx)("a",{href:"/app",className:"text-sm text-emerald-600 hover:text-emerald-700",children:"← Back to App"})]})})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"border-b border-gray-200 px-6 py-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Content Reports (",d,")"]}),(0,r.jsx)("div",{className:"flex gap-2",children:["pending","reviewed","dismissed"].map(e=>(0,r.jsx)("button",{onClick:()=>p(e),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-colors ".concat(x===e?"bg-emerald-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})}),m&&(0,r.jsx)("div",{className:"px-6 py-4 bg-red-50 border-b border-red-100",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:m})}),o?(0,r.jsxs)("div",{className:"px-6 py-12 text-center",children:[(0,r.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-emerald-600 border-t-transparent rounded-full mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-500",children:"Loading reports..."})]}):0===t.length?(0,r.jsx)("div",{className:"px-6 py-12 text-center",children:(0,r.jsxs)("p",{className:"text-gray-500",children:["No ",x," reports found."]})}):(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:t.map(e=>{var t,s,a,i;return(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full ".concat(k(e.reason)),children:e.reason}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:_(e.created_at)})]}),(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:(null===(t=e.animation)||void 0===t?void 0:t.title)||"Deleted Animation"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["by ",(null===(s=e.animation)||void 0===s?void 0:s.author_display_name)||"Anonymous"]})]}),e.details&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 bg-gray-50 rounded p-2 mb-2",children:['"',e.details,'"']}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Reported by: ",(null===(a=e.reporter)||void 0===a?void 0:a.display_name)||"Anonymous User"]}),(null===(i=e.animation)||void 0===i?void 0:i.id)&&(0,r.jsx)("a",{href:"/gallery/".concat(e.animation.id),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-emerald-600 hover:text-emerald-700 mt-1 inline-block",children:"View Animation →"})]}),"pending"===x&&(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("button",{onClick:()=>w(e.id,"dismiss"),disabled:h===e.id,className:"px-3 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 rounded hover:bg-gray-200 disabled:opacity-50",children:"Dismiss"}),(0,r.jsx)("button",{onClick:()=>w(e.id,"hide"),disabled:h===e.id,className:"px-3 py-1.5 text-xs font-medium text-amber-700 bg-amber-100 rounded hover:bg-amber-200 disabled:opacity-50",children:"Hide"}),(0,r.jsx)("button",{onClick:()=>w(e.id,"delete"),disabled:h===e.id,className:"px-3 py-1.5 text-xs font-medium text-red-700 bg-red-100 rounded hover:bg-red-200 disabled:opacity-50",children:"Delete"}),(0,r.jsx)("button",{onClick:()=>w(e.id,"warn_user"),disabled:h===e.id,className:"px-3 py-1.5 text-xs font-medium text-orange-700 bg-orange-100 rounded hover:bg-orange-200 disabled:opacity-50",children:"Warn User"}),(0,r.jsx)("button",{onClick:()=>w(e.id,"ban_user"),disabled:h===e.id,className:"px-3 py-1.5 text-xs font-medium text-white bg-red-600 rounded hover:bg-red-700 disabled:opacity-50",children:"Ban User"})]})]})},e.id)})})]})}),y&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["hide"===y.action&&"Hide Animation","warn_user"===y.action&&"Warn User","ban_user"===y.action&&"Ban User"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for this action. This will be recorded for audit purposes."}),(0,r.jsx)("textarea",{value:b,onChange:e=>f(e.target.value),placeholder:"Enter reason...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none",rows:3}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 mt-4",children:[(0,r.jsx)("button",{onClick:()=>{v(null),f("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>w(y.reportId,y.action,b),disabled:!b.trim()||h===y.reportId,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:h===y.reportId?"Processing...":"Confirm"})]})]})})]})}},970:function(e,t,s){"use strict";s.d(t,{W:function(){return a}});var r=s(1259);function a(){return(0,r.createBrowserClient)("https://qwivksrxdvrcvuwzmbvr.supabase.co","sb_publishable_J07j1EdYOeUC_tbpoC7AQQ_cjGoXWdP")}},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[259,971,734,744],function(){return e(e.s=8937)}),_N_E=e.O()}]);